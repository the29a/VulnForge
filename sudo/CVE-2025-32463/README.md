# CVE-2025-32462 / CVE-2025-32463
Sudo before 1.9.17p1 allows local users to obtain root access because /etc/nsswitch.conf from a user-controlled directory is used with the --chroot option.

## Metrics
MITRE Base Score:  9.3 CRITICAL

## Vulnerability Environment
Build and run:
```bash
docker compose build
docker compose up -d
```
Stop Environment and remove network:
```bash
docker compose down
```

## Detection and exploitation example
1. Run environment
2. Dive into container: 

```shell
docker exec -it b3 /bin/bash
vulnforge@b389371d6aed:~$ ./CVE-2025-32463.sh 
woot!
root@b389371d6aed:/# id
uid=0(root) gid=0(root) groups=0(root),1001(vulnforge)
root@b389371d6aed:/# 
```
3. Or use ssh (vulnforge\vulnforge123)

```shell
ssh vulnforge@192.168.93.63 -p 2222
vulnforge@192.168.93.63's password: 

vulnforge@2cac9fc71e0f:~$ ./CVE-2025-32463.sh 
woot!
root@2cac9fc71e0f:/# id
uid=0(root) gid=0(root) groups=0(root),1001(vulnforge)
root@2cac9fc71e0f:/# 
```
## Exploits and PoCs
https://github.com/kh4sh3i/CVE-2025-32463  

## CTF Rooms

## References
[NIST: CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)  
[stratascale: Vulnerability Advisory: Sudo chroot Elevation of Privilege](https://www.stratascale.com/vulnerability-alert-CVE-2025-32463-sudo-chroot)  

