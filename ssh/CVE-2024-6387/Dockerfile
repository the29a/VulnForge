FROM i386/debian:12.5

LABEL maintainer="the29a"

ENV DEBIAN_FRONTEND=noninteractive
RUN dpkg --add-architecture i386 && apt-get update && apt-get install -y \
    bash \
    openssh-client=1:9.2p1-2+deb12u2 \
    default-logind \
    libpam-systemd \
    ncurses-term \
    xauth \
    openssh-sftp-server=1:9.2p1-2+deb12u2 \
    openssh-server=1:9.2p1-2+deb12u2


RUN useradd -rm -d /home/docker -s /bin/bash -g root -G sudo -u 1000 docker
RUN echo 'docker:docker' | chpasswd
RUN mkdir /var/run/sshd

RUN echo 'PermitRootLogin yes' >> /etc/ssh/sshd_config
RUN echo 'PasswordAuthentication yes' >> /etc/ssh/sshd_config
RUN echo 'LoginGraceTime 2m' >> /etc/ssh/sshd_config

EXPOSE 22
CMD ["/usr/sbin/sshd", "-D"]
