# CVE-2024-6387
A security regression (CVE-2006-5051) was discovered in OpenSSH's server (sshd). There is a race condition which can lead sshd to handle some signals in an unsafe manner. An unauthenticated, remote attacker may be able to trigger it by failing to authenticate within a set time period.

## Metrics
CVSSv2: N\A
CVSSv3: 8.1 HIGH

## Vulnerability Environment
Build and run:
```
docker compose build
docker compose up -d
```

## Detection and exploitation example
### Detection
In example, we can use [PoC by asterictnl-lvdw](https://github.com/asterictnl-lvdw/CVE-2024-6387):
```
python3 CVE-2024-6387.py scan -T 192.168.93.63 -p 2222
```
### Exloitation
> [!CAUTION]
> Probably an unexploitable version, maybe need older packages or building from source.
```
python3 CVE-2024-6387.py exploit -T 192.168.93.63 -p 2222 -n wlan0
```

## Exploits and PoCs
https://github.com/l0n3m4n/CVE-2024-6387  
https://github.com/asterictnl-lvdw/CVE-2024-6387  
https://github.com/acrono/cve-2024-6387-poc  
https://github.com/identity-threat-labs/Article-RegreSSHion-CVE-2024-6387  
https://github.com/identity-threat-labs/CVE-2024-6387-Vulnerability-Checker  
https://github.com/HadesNull123/CVE-2024-6387_Check  
https://github.com/almogopp/OpenSSH-CVE-2024-6387-Fix  
https://github.com/alex14324/ssh_poc2024  
https://github.com/l-urk/CVE-2024-6387  
https://github.com/ThatNotEasy/CVE-2024-6387  
https://github.com/Jhonsonwannaa/CVE-2024-6387  
https://github.com/k4t3pr0/CVE-2024-6387-Check  


## Nuclei Template

## CTF Rooms

## References
https://nvd.nist.gov/vuln/detail/CVE-2024-6387  
https://www.qualys.com/2024/07/01/cve-2024-6387/regresshion.txt  
https://avd.aquasec.com/nvd/2024/cve-2024-6387/  
https://security-tracker.debian.org/tracker/CVE-2024-6387  

## To-do
Find exploitable version.  
