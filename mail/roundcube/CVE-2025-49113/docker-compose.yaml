networks:
  vulnforge:
    driver: bridge
    ipam:
      config:
        - subnet: 172.90.0.0/16
          ip_range: 172.90.240.0/20

services:
  db:
    image: mariadb:10.11-ubi
    command: '--default-authentication-plugin=mysql_native_password'
    restart: always
    environment:
      - MYSQL_ROOT_PASSWORD=mariadb_password
      - MYSQL_DATABASE=roundcube
      - MYSQL_USER=roundcube
      - MYSQL_PASSWORD=roundcube
    networks:
      - vulnforge
    expose:
      - "3306:3306"
      - "33060:33060"

  
  roundcube:
    build:
      context: .
      dockerfile: Dockerfile
#      args:
#    environment:
    container_name: cve-2025-49113-roundcube
    depends_on:
      - db
    networks:
     - vulnforge
    ports:
      - 80:80
      - 143:143
    restart: always
    command: /usr/local/bin/init.sh

